#!/usr/bin/env node

/**
 * This script runs typedoc with the args provided, and then runs
 * the custom script prepend on the location of the main.js file
 * generated by the typedoc command.
 */

const { exec } = require("child_process");

const typedocArgs = process.argv.slice(process.argv.indexOf("--out"));

const cmd = `typedoc ${typedocArgs.join(" ")}`;
console.log("[exec]", cmd);

exec(cmd, (error, stdout, stderr) => {
  console.log(stdout);
  console.log(stderr);
  if (error) {
    console.error(e);
    return process.exit(error.code || 1);
  }
  try {
    require("./prepend-script");
  } catch (e) {
    console.error(e);
    process.exit(1);
  }
});
